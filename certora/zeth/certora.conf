# Certora Configuration File for ZeroMoon zETH
# Maximum Coverage Verification Settings
# Equivalent to Foundry's 10M fuzz + 1M invariant tests

# Main contract to verify
verify ZeroMoon:zeth-comprehensive.spec

# Solidity compiler settings
solc solc_0_8_30
solc_optimize 200
solc_optimize_map yes
solc_via_ir no

# Maximum timeout settings for exhaustive verification
# These are the "overkill" settings equivalent to Foundry's maximum profile
smt_timeout 1800                    # 30 minutes per rule (vs default 600s)
global_timeout 14400                # 4 hours total (vs default 3600s)
loop_iter 5                         # Unroll loops up to 5 iterations
smt_useOption true                  # Use advanced SMT solver options
smt_nonLinearArithmetic true        # Enable non-linear arithmetic reasoning

# Advanced solver settings for maximum coverage
smt_hashingScheme plain              # Use plain hashing for better coverage
smt_initialValueDepth 2              # Initial value depth for state exploration
smt_initialValueDepthMax 5           # Maximum initial value depth

# Memory and resource limits (increase for exhaustive verification)
memory_limit 32                      # 32GB memory limit
smt_parallelism 8                    # Use 8 parallel SMT solvers

# Verification depth and coverage
depth 20                             # Maximum call depth (equivalent to Foundry depth 20)
optimistic_loop true                 # Optimistic loop handling
optimistic_hashing true              # Optimistic hashing

# Rule-specific timeouts (can override global for specific rules)
# These can be set per-rule in the spec file if needed

# Path settings
rule_sanity time
rule_sanity basic
rule_sanity advanced

# Output settings
msg "ZeroMoon zETH - Maximum Coverage Formal Verification"
json_output "certora-results.json"
log_level 3                          # Detailed logging

# Source files
files = [
    "src/ZeroMoon.sol"
]

# Libraries (OpenZeppelin)
link = [
    "ZeroMoon:ERC20=ERC20",
    "ZeroMoon:ERC20Permit=ERC20Permit",
    "ZeroMoon:Ownable2Step=Ownable2Step",
    "ZeroMoon:ReentrancyGuard=ReentrancyGuard"
]

# Remappings
remap = [
    "@openzeppelin/=lib/openzeppelin-contracts/"
]

# Advanced verification options
packages = [
    "@openzeppelin/=lib/openzeppelin-contracts/"
]

# Disable certain optimizations for better verification coverage
disableLocalTypeChecking = false
disableSMT = false

# Enable all verification modes
verify = true
check = true

